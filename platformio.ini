; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env:disco_l475vg_iot01a]
platform = ststm32
board = disco_l475vg_iot01a
framework = mbed

lib_deps = 
    # 不使用 CMSIS-DSP，使用自己实现的 FFT

build_flags =
    -DMBED_CONF_RTOS_PRESENT=1
    -std=c++14
    -Wno-register
    -Wl,-u,_printf_float  ; 启用 printf 浮点数支持
    -Wl,-u,_scanf_float   ; 启用 scanf 浮点数支持
    -DMBED_CONF_PLATFORM_STDIO_MINIMAL_CONSOLE_ONLY=0  ; 禁用最小化控制台

monitor_speed = 115200
monitor_dtr = 0
monitor_rts = 0
upload_protocol = stlink

; 选择使用哪个主程序
;
; 完整应用 (默认): main.cpp + 所有依赖
; 简单测试: main_simple.cpp (交互式菜单)
; 串口测试: main_stdio_test.cpp (验证串口工作)
;
; 测试：不包含 BLE，看传感器和检测器是否正常
build_src_filter =
    -<*>
    +<main.cpp>
    +<sensor.cpp>
    +<detector.cpp>
    +<fft_processor.cpp>
    +<ble_service.cpp>

; 简单测试版本：
; build_src_filter =
;     -<*>
;     +<main_simple.cpp>

